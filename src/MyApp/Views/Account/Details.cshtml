@using MyApp.Domain.Users
@model MyApp.Web.ViewModels.DetailsViewModel;

@{
    ViewData["Title"] = "Szczegóły konta";
    var user = Model.User;
    if (User.IsInRole("Admin"))
    {
        Layout = "_AdminLayout";
    }
    else if (User.IsInRole("Pharmacist"))
    {
        Layout = "_PharmacistLayout";
    }
    else
    {
        Layout = "_PatientLayout";
    }
}

<div class="card mb-4">
    <div class="card-body">
        <dl class="row mb-0">
            <dt class="col-sm-3">Email</dt>
            <dd class="col-sm-9">@user.Email</dd>
            <dt class="col-sm-3">Imię</dt>
            <dd class="col-sm-9">@user.DisplayName</dd>
            <dt class="col-sm-3">Utworzono</dt>
            <dd class="col-sm-9">@user.CreatedUtc.ToString("yyyy-MM-dd HH:mm")</dd>
        </dl>
    </div>
</div>

<div class="d-grid gap-2 d-sm-flex justify-content-sm-center mt-3">
    <a class="btn btn-success" asp-action="ChangeEmail">Zmień email</a>
    <a class="btn btn-success" asp-action="ChangePassword">Zmień hasło</a>
    <a class="btn btn-success" asp-action="EditProfile">Zmień dane konta</a>
    @if ((!User.IsInRole("Admin")) && (!User.IsInRole("Pharmacist")))
    {
        <a class="btn btn-success" asp-action="PromoteToPharmacist">Zarejestruj jako Farmaceuta.</a>
    }
    @if(!User.IsInRole("Admin"))
    {
        <button type="button"
                class="btn btn-outline-success"
                data-bs-toggle="modal"
                data-bs-target="#deleteAccountModal">
            Usuń konto
        </button>
    }
</div>

@if (!User.IsInRole("Admin"))
{
    <div class="modal fade"
         id="deleteAccountModal"
         tabindex="-1"
         aria-labelledby="deleteAccountModalLabel"
         aria-hidden="true"
         data-bs-backdrop="static"
         data-bs-keyboard="false">

        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">

                <div class="modal-header">
                    <h5 class="modal-title" id="deleteAccountModalLabel">
                        Potwierdzenie usunięcia konta
                    </h5>
                    <button type="button"
                            class="btn-close"
                            data-bs-dismiss="modal"
                            aria-label="Zamknij"></button>
                </div>

                <div class="modal-body">
                    <p class="mb-0">
                        Czy na pewno chcesz <strong>trwale usunąć konto</strong>?
                        <br />
                        Tej operacji nie można cofnąć.
                    </p>
                </div>

                <div class="modal-footer">
                    <button type="button"
                            class="btn btn-outline-secondary"
                            data-bs-dismiss="modal">
                        Anuluj
                    </button>

                    <form asp-action="DeleteProfile" method="post" class="m-0">
                        <button type="submit" class="btn btn-danger">
                            Usuń konto
                        </button>
                    </form>
                </div>

            </div>
        </div>
    </div>
}