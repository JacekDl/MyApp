@model List<MyApp.Domain.Users.UserDto>

@{
    var infoMsg = TempData["Info"] as string;
    var errMsg = TempData["Error"] as string;
}

<partial name="~/Views/Shared/_AdminNav.cshtml" />

<div class="container mt-3">
    @if (!string.IsNullOrWhiteSpace(infoMsg) || !string.IsNullOrWhiteSpace(errMsg))
    {
            <div class="toast-container position-fixed top-0 end-0 p-3 z-3" style="pointer-events: none;">
                @if (!string.IsNullOrWhiteSpace(infoMsg))
                {
                    <div class="toast text-bg-success border-0 mb-2" role="alert" aria-live="assertive" aria-atomic="true" data-bs-autohide="true" data-bs-delay="5000" style="pointer-events: auto;">
                        <div class="toast-header bg-success text-white">
                            <strong class="me-auto">Success</strong>
                            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast" aria-label="Close"></button>
                        </div>
                        <div class="toast-body">
                            @infoMsg
                        </div>
                    </div>
                }
                @if (!string.IsNullOrWhiteSpace(errMsg))
                {
                    <div class="toast text-bg-danger border-0" role="alert" aria-live="assertive" aria-atomic="true" data-bs-autohide="false" style="pointer-events: auto;">
                        <div class="toast-header bg-danger text-white">
                            <strong class="me-auto">Error</strong>
                            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast" aria-label="Close"></button>
                        </div>
                        <div class="toast-body">
                            @errMsg
                        </div>
                    </div>
                }
            </div>
    }
    <div class="table-responsive">
        <table class="table table-sm table-striped align-middle">
            <thead>
                <tr>
                    <th scope="col">Id</th>
                    <th scope="col">Email</th>
                    <th scope="col">Role</th>
                    <th scope="col">Created</th>
                    <th scope="col"></th>
                </tr>
            </thead>
            <tbody>
                @foreach(var user in Model)
                {
                    <tr>
                        <td>@user.Id</td>
                        <td>@user.Email</td>
                        <td>@user.Role</td>
                        <td>@user.CreatedUtc.ToString("yyyy-MM-dd HH:mm")</td>
                        <td>
                            @if (!string.Equals(user.Role, "Admin", StringComparison.OrdinalIgnoreCase))
                            {
                                <form asp-action="RemoveUser" method="post" asp-route-id="@user.Id" style="display:inline">
                                    @Html.AntiForgeryToken()
                                    <button 
                                        type="submit" 
                                        class="btn btn-sm btn-outline-danger"
                                        onclick="return confirm('Are you sure you want to remove this user?');">
                                        Delete
                                    </button>
                                </form>
                            }
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>
